<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WALIA-RX Console Subsystem</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.2.0/css/bootstrap.min.css" rel="stylesheet">
    <link href="style.css" rel="stylesheet">
</head>
<body>
    <div class="container-fluid h-100">
        <div class="row h-100">
            <!-- Sidebar Navigation -->
            <div class="col-md-2 sidebar">
                <div class="sidebar-header">
                    <h4>WALIA-RX</h4>
                    <small class="text-muted">v1.0.0-PRD</small>
                </div>
                <nav class="nav flex-column">
                    <a class="nav-link active" href="#" data-view="terminal">
                        <i class="fas fa-terminal"></i> Terminal
                    </a>
                    <a class="nav-link" href="#" data-view="shell">
                        <i class="fas fa-code"></i> Ion Shell
                    </a>
                    <a class="nav-link" href="#" data-view="filesystem">
                        <i class="fas fa-folder"></i> FS Utils
                    </a>
                    <a class="nav-link" href="#" data-view="observability">
                        <i class="fas fa-chart-line"></i> Observability
                    </a>
                    <a class="nav-link" href="#" data-view="architecture">
                        <i class="fas fa-sitemap"></i> Architecture
                    </a>
                </nav>
                
                <!-- Performance Metrics -->
                <div class="metrics-panel mt-4">
                    <h6>Live Metrics</h6>
                    <div class="metric">
                        <small>Input Latency</small>
                        <div class="metric-value" id="input-latency">2.1ms</div>
                    </div>
                    <div class="metric">
                        <small>Memory RSS</small>
                        <div class="metric-value" id="memory-rss">8.4MB</div>
                    </div>
                    <div class="metric">
                        <small>Session Uptime</small>
                        <div class="metric-value" id="uptime">00:12:34</div>
                    </div>
                </div>
            </div>

            <!-- Main Content -->
            <div class="col-md-10 main-content">
                <!-- Terminal View -->
                <div id="terminal-view" class="view active">
                    <div class="view-header">
                        <h5><i class="fas fa-terminal"></i> Terminal Emulator</h5>
                        <div class="terminal-controls">
                            <button class="btn btn-sm btn-outline-secondary" id="clear-terminal">
                                <i class="fas fa-trash"></i> Clear
                            </button>
                            <button class="btn btn-sm btn-outline-secondary" id="toggle-replay">
                                <i class="fas fa-play"></i> Replay
                            </button>
                            <button class="btn btn-sm btn-outline-secondary" id="export-session">
                                <i class="fas fa-download"></i> Export
                            </button>
                        </div>
                    </div>
                    <div class="terminal-container">
                        <div id="terminal-output" class="terminal-output"></div>
                        <div class="terminal-input-line">
                            <span class="prompt">user@redox:~$</span>
                            <input type="text" id="terminal-input" class="terminal-input" autocomplete="off" spellcheck="false">
                        </div>
                    </div>
                    
                    <!-- Terminal Status Bar -->
                    <div class="terminal-status">
                        <span>Lines: <span id="line-count">0</span></span>
                        <span>Scrollback: <span id="scrollback-size">0KB</span></span>
                        <span>Mode: <span id="terminal-mode">Interactive</span></span>
                    </div>
                </div>

                <!-- Shell View -->
                <div id="shell-view" class="view">
                    <div class="view-header">
                        <h5><i class="fas fa-code"></i> Ion Shell</h5>
                    </div>
                    <div class="row">
                        <div class="col-md-8">
                            <div class="card">
                                <div class="card-header">
                                    <h6>Command Parser</h6>
                                </div>
                                <div class="card-body">
                                    <textarea id="shell-input" class="form-control font-monospace" rows="6" placeholder="Enter Ion shell commands..."></textarea>
                                    <div class="mt-2">
                                        <button class="btn btn-primary btn-sm" id="parse-command">Parse</button>
                                        <button class="btn btn-secondary btn-sm" id="validate-syntax">Validate</button>
                                    </div>
                                    <div id="parser-output" class="mt-3"></div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="card">
                                <div class="card-header">
                                    <h6>Job Control</h6>
                                </div>
                                <div class="card-body">
                                    <div id="job-list" class="job-list"></div>
                                </div>
                            </div>
                            <div class="card mt-3">
                                <div class="card-header">
                                    <h6>Builtins</h6>
                                </div>
                                <div class="card-body">
                                    <div class="builtin-list">
                                        <div class="builtin-item">cd, pwd, echo</div>
                                        <div class="builtin-item">test, set, export</div>
                                        <div class="builtin-item">alias, history</div>
                                        <div class="builtin-item">pushd, popd, dirs</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Filesystem View -->
                <div id="filesystem-view" class="view">
                    <div class="view-header">
                        <h5><i class="fas fa-folder"></i> Filesystem Utilities</h5>
                    </div>
                    <div class="row">
                        <div class="col-md-6">
                            <div class="card">
                                <div class="card-header">
                                    <h6>Available Tools</h6>
                                </div>
                                <div class="card-body">
                                    <div class="fs-tools-grid">
                                        <div class="fs-tool" data-tool="ls">
                                            <i class="fas fa-list"></i> ls
                                        </div>
                                        <div class="fs-tool" data-tool="cp">
                                            <i class="fas fa-copy"></i> cp
                                        </div>
                                        <div class="fs-tool" data-tool="mv">
                                            <i class="fas fa-arrows-alt"></i> mv
                                        </div>
                                        <div class="fs-tool" data-tool="rm">
                                            <i class="fas fa-trash"></i> rm
                                        </div>
                                        <div class="fs-tool" data-tool="mkdir">
                                            <i class="fas fa-folder-plus"></i> mkdir
                                        </div>
                                        <div class="fs-tool" data-tool="cat">
                                            <i class="fas fa-file-alt"></i> cat
                                        </div>
                                        <div class="fs-tool" data-tool="find">
                                            <i class="fas fa-search"></i> find
                                        </div>
                                        <div class="fs-tool" data-tool="du">
                                            <i class="fas fa-chart-pie"></i> du
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="card">
                                <div class="card-header">
                                    <h6>Command Builder</h6>
                                </div>
                                <div class="card-body">
                                    <div class="mb-3">
                                        <label class="form-label">Selected Tool: <span id="selected-tool">None</span></label>
                                        <input type="text" id="fs-command" class="form-control font-monospace" placeholder="Click a tool to build command">
                                    </div>
                                    <div class="mb-3">
                                        <button class="btn btn-primary btn-sm" id="execute-fs-command">Execute</button>
                                        <button class="btn btn-outline-secondary btn-sm" id="show-help">Help</button>
                                    </div>
                                    <div id="fs-output" class="fs-output"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Observability View -->
                <div id="observability-view" class="view">
                    <div class="view-header">
                        <h5><i class="fas fa-chart-line"></i> Observability Dashboard</h5>
                    </div>
                    <div class="row">
                        <div class="col-md-4">
                            <div class="card">
                                <div class="card-header">
                                    <h6>Performance Metrics</h6>
                                </div>
                                <div class="card-body">
                                    <canvas id="latency-chart" width="300" height="200"></canvas>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-8">
                            <div class="card">
                                <div class="card-header">
                                    <h6>Structured Logs</h6>
                                    <div class="log-controls">
                                        <select id="log-level" class="form-select form-select-sm">
                                            <option value="all">All Levels</option>
                                            <option value="error">Error</option>
                                            <option value="warn">Warning</option>
                                            <option value="info">Info</option>
                                            <option value="debug">Debug</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="card-body">
                                    <div id="log-output" class="log-output"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row mt-3">
                        <div class="col-12">
                            <div class="card">
                                <div class="card-header">
                                    <h6>Session Traces</h6>
                                </div>
                                <div class="card-body">
                                    <div id="trace-timeline" class="trace-timeline"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Architecture View -->
                <div id="architecture-view" class="view">
                    <div class="view-header">
                        <h5><i class="fas fa-sitemap"></i> Module Architecture</h5>
                    </div>
                    <div class="architecture-diagram">
                        <svg id="architecture-svg" width="100%" height="600" viewBox="0 0 1000 600">
                            <!-- Module boxes will be drawn by JavaScript -->
                        </svg>
                    </div>
                    <div class="row mt-3">
                        <div class="col-md-6">
                            <div class="card">
                                <div class="card-header">
                                    <h6>Module Details</h6>
                                </div>
                                <div class="card-body">
                                    <div id="module-info">
                                        <p>Click on a module in the diagram to see details</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="card">
                                <div class="card-header">
                                    <h6>Interface Boundaries</h6>
                                </div>
                                <div class="card-body">
                                    <div id="interface-info">
                                        <p>Module interfaces and data flows</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.2.0/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/chart.js/3.9.1/chart.min.js"></script>
    <script src="modules/telemetry.js"></script>
    <script src="modules/tty-pty.js"></script>
    <script src="modules/cli-core.js"></script>
    <script src="modules/fs-utils.js"></script>
    <script src="modules/term-core.js"></script>
    <script src="modules/ion-core.js"></script>
    <script src="app.js"></script>
</body>
</html>
